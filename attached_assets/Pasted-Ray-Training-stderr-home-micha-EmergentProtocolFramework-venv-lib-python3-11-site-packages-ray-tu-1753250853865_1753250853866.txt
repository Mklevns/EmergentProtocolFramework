Ray Training stderr: /home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/tune/logger/unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `TBXLogger interface is deprecated in favor of the `ray.tune.tensorboardx.TBXLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))

11:06:30 PM [express] GET /api/training/status 304 in 1ms :: {"experiment":{"name":"test","descriptio…
11:06:30 PM [express] GET /api/metrics/experiment/4 304 in 1ms :: []
11:06:31 PM [express] GET /api/metrics/experiment/4 304 in 0ms :: []
11:06:32 PM [express] GET /api/training/status 304 in 1ms :: {"experiment":{"name":"test","descriptio…
11:06:32 PM [express] GET /api/metrics/experiment/4 304 in 0ms :: []
11:06:33 PM [express] GET /api/metrics/experiment/4 304 in 1ms :: []
Ray Training stderr: (RolloutWorker pid=54762) INFO:services.marl_framework:MARL Framework initialized
(RolloutWorker pid=54762) INFO:services.ray_full_integration:BioInspiredMultiAgentEnv initialized with 30 agents

Ray Training stderr: (RolloutWorker pid=54763) Exception raised in creation task: The actor died because of an error raised in its creation task, ray::RolloutWorker.__init__() (pid=54763, ip=172.23.15.241, actor_id=7e582e93e89fe18e6192985c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x762e09d0bc90>)
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_base.py", line 63, in validate
(RolloutWorker pid=54763)     raise ValueError(_INVALID_TYPE.format(self.dtype, type(data)))
(RolloutWorker pid=54763) ValueError: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

Ray Training stderr: (RolloutWorker pid=54763)
(RolloutWorker pid=54763) During handling of the above exception, another exception occurred:
(RolloutWorker pid=54763)
(RolloutWorker pid=54763) ray::RolloutWorker.__init__() (pid=54763, ip=172.23.15.241, actor_id=7e582e93e89fe18e6192985c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x762e09d0bc90>)
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 160, in _validate
(RolloutWorker pid=54763)     spec.validate(data)
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_dict.py", line 141, in validate
(RolloutWorker pid=54763)     raise ValueError(
(RolloutWorker pid=54763) ValueError: Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>
(RolloutWorker pid=54763)
(RolloutWorker pid=54763) During handling of the above exception, another exception occurred:
(RolloutWorker pid=54763)
(RolloutWorker pid=54763) ray::RolloutWorker.__init__() (pid=54763, ip=172.23.15.241, actor_id=7e582e93e89fe18e6192985c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x762e09d0bc90>)
(RolloutWorker pid=54763)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 535, in __init__
(RolloutWorker pid=54763)     self._update_policy_map(policy_dict=self.policy_dict)
(RolloutWorker pid=54763)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1746, in _update_policy_map
(RolloutWorker pid=54763)     self._build_policy_map(
(RolloutWorker pid=54763)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1857, in _build_policy_map
(RolloutWorker pid=54763)     new_policy = create_policy_for_framework(
(RolloutWorker pid=54763)                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/policy.py", line 141, in create_policy_for_framework
(RolloutWorker pid=54763)     return policy_class(observation_space, action_space, merged_config)
(RolloutWorker pid=54763)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/ppo/ppo_torch_policy.py", line 64, in __init__
(RolloutWorker pid=54763)     self._initialize_loss_from_dummy_batch()
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/policy.py", line 1430, in _initialize_loss_from_dummy_batch
(RolloutWorker pid=54763)     actions, state_outs, extra_outs = self.compute_actions_from_input_dict(
(RolloutWorker pid=54763)                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 552, in compute_actions_from_input_dict
(RolloutWorker pid=54763)     return self._compute_action_helper(
(RolloutWorker pid=54763)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/threading.py", line 24, in wrapper
(RolloutWorker pid=54763)     return func(self, *a, **k)
(RolloutWorker pid=54763)            ^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 1208, in _compute_action_helper
(RolloutWorker pid=54763)     fwd_out = self.model.forward_exploration(input_dict)
(RolloutWorker pid=54763)               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 253, in wrapper
(RolloutWorker pid=54763)     raise e
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 251, in wrapper
(RolloutWorker pid=54763)     return func(self, input_data, **kwargs)
(RolloutWorker pid=54763)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 371, in wrapper
(RolloutWorker pid=54763)     _validate(
(RolloutWorker pid=54763)   File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 162, in _validate
(RolloutWorker pid=54763)     raise SpecCheckingError(
(RolloutWorker pid=54763) ray.rllib.core.models.specs.checker.SpecCheckingError: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.

Ray Training stderr: 2025-07-22 23:06:33,771    ERROR actor_manager.py:506 -- Ray error, taking actor 1 out of service. The actor died because of an error raised in its creation task, ray::RolloutWorker.__init__() (pid=54761, ip=172.23.15.241, actor_id=e9977887cdbd2ef08b344d5c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x76e18e94fe10>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_base.py", line 63, in validate
    raise ValueError(_INVALID_TYPE.format(self.dtype, type(data)))
ValueError: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54761, ip=172.23.15.241, actor_id=e9977887cdbd2ef08b344d5c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x76e18e94fe10>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 160, in _validate
    spec.validate(data)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_dict.py", line 141, in validate
    raise ValueError(
ValueError: Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54761, ip=172.23.15.241, actor_id=e9977887cdbd2ef08b344d5c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x76e18e94fe10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 535, in __init__
    self._update_policy_map(policy_dict=self.policy_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1746, in _update_policy_map
    self._build_policy_map(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1857, in _build_policy_map
    new_policy = create_policy_for_framework(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/policy.py", line 141, in create_policy_for_framework
    return policy_class(observation_space, action_space, merged_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/ppo/ppo_torch_policy.py", line 64, in __init__
    self._initialize_loss_from_dummy_batch()
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/policy.py", line 1430, in _initialize_loss_from_dummy_batch
    actions, state_outs, extra_outs = self.compute_actions_from_input_dict(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 552, in compute_actions_from_input_dict
    return self._compute_action_helper(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/threading.py", line 24, in wrapper
    return func(self, *a, **k)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 1208, in _compute_action_helper
    fwd_out = self.model.forward_exploration(input_dict)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 253, in wrapper
    raise e
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 251, in wrapper
    return func(self, input_data, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 371, in wrapper
    _validate(
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 162, in _validate
    raise SpecCheckingError(
ray.rllib.core.models.specs.checker.SpecCheckingError: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.

Ray Training stderr: 2025-07-22 23:06:33,771    ERROR actor_manager.py:506 -- Ray error, taking actor 2 out of service. The actor died because of an error raised in its creation task, ray::RolloutWorker.__init__() (pid=54762, ip=172.23.15.241, actor_id=90c7b723e81644f073dbdd2401000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x7ceb6a96d450>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_base.py", line 63, in validate
    raise ValueError(_INVALID_TYPE.format(self.dtype, type(data)))
ValueError: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54762, ip=172.23.15.241, actor_id=90c7b723e81644f073dbdd2401000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x7ceb6a96d450>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 160, in _validate
    spec.validate(data)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_dict.py", line 141, in validate
    raise ValueError(
ValueError: Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54762, ip=172.23.15.241, actor_id=90c7b723e81644f073dbdd2401000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x7ceb6a96d450>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 535, in __init__
    self._update_policy_map(policy_dict=self.policy_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1746, in _update_policy_map
    self._build_policy_map(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1857, in _build_policy_map
    new_policy = create_policy_for_framework(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/policy.py", line 141, in create_policy_for_framework
    return policy_class(observation_space, action_space, merged_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/ppo/ppo_torch_policy.py", line 64, in __init__
    self._initialize_loss_from_dummy_batch()
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/policy.py", line 1430, in _initialize_loss_from_dummy_batch
    actions, state_outs, extra_outs = self.compute_actions_from_input_dict(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 552, in compute_actions_from_input_dict
    return self._compute_action_helper(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/threading.py", line 24, in wrapper
    return func(self, *a, **k)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 1208, in _compute_action_helper
    fwd_out = self.model.forward_exploration(input_dict)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 253, in wrapper
    raise e
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 251, in wrapper
    return func(self, input_data, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 371, in wrapper
    _validate(
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 162, in _validate
    raise SpecCheckingError(
ray.rllib.core.models.specs.checker.SpecCheckingError: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.
2025-07-22 23:06:33,771 ERROR actor_manager.py:506 -- Ray error, taking actor 3 out of service. The actor died because of an error raised in its creation task, ray::RolloutWorker.__init__() (pid=54763, ip=172.23.15.241, actor_id=7e582e93e89fe18e6192985c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x762e09d0bc90>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_base.py", line 63, in validate
    raise ValueError(_INVALID_TYPE.format(self.dtype, type(data)))
ValueError: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54763, ip=172.23.15.241, actor_id=7e582e93e89fe18e6192985c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x762e09d0bc90>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 160, in _validate
    spec.validate(data)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_dict.py", line 141, in validate
    raise ValueError(
ValueError: Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54763, ip=172.23.15.241, actor_id=7e582e93e89fe18e6192985c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x762e09d0bc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 535, in __init__
    self._update_policy_map(policy_dict=self.policy_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1746, in _update_policy_map
    self._build_policy_map(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1857, in _build_policy_map
    new_policy = create_policy_for_framework(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/policy.py", line 141, in create_policy_for_framework
    return policy_class(observation_space, action_space, merged_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/ppo/ppo_torch_policy.py", line 64, in __init__
    self._initialize_loss_from_dummy_batch()
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/policy.py", line 1430, in _initialize_loss_from_dummy_batch
    actions, state_outs, extra_outs = self.compute_actions_from_input_dict(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 552, in compute_actions_from_input_dict
    return self._compute_action_helper(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/threading.py", line 24, in wrapper
    return func(self, *a, **k)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 1208, in _compute_action_helper
    fwd_out = self.model.forward_exploration(input_dict)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 253, in wrapper
    raise e
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 251, in wrapper
    return func(self, input_data, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 371, in wrapper
    _validate(
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 162, in _validate
    raise SpecCheckingError(
ray.rllib.core.models.specs.checker.SpecCheckingError: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.
2025-07-22 23:06:33,772 ERROR actor_manager.py:506 -- Ray error, taking actor 4 out of service. The actor died because of an error raised in its creation task, ray::RolloutWorker.__init__() (pid=54764, ip=172.23.15.241, actor_id=99689ff6be87f0e0a6129be301000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x7d1edf74bad0>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_base.py", line 63, in validate
    raise ValueError(_INVALID_TYPE.format(self.dtype, type(data)))
ValueError: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54764, ip=172.23.15.241, actor_id=99689ff6be87f0e0a6129be301000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x7d1edf74bad0>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 160, in _validate
    spec.validate(data)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_dict.py", line 141, in validate
    raise ValueError(
ValueError: Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54764, ip=172.23.15.241, actor_id=99689ff6be87f0e0a6129be301000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x7d1edf74bad0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 535, in __init__
    self._update_policy_map(policy_dict=self.policy_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1746, in _update_policy_map
    self._build_policy_map(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1857, in _build_policy_map
    new_policy = create_policy_for_framework(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/policy.py", line 141, in create_policy_for_framework
    return policy_class(observation_space, action_space, merged_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/ppo/ppo_torch_policy.py", line 64, in __init__
    self._initialize_loss_from_dummy_batch()
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/policy.py", line 1430, in _initialize_loss_from_dummy_batch
    actions, state_outs, extra_outs = self.compute_actions_from_input_dict(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 552, in compute_actions_from_input_dict
    return self._compute_action_helper(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/threading.py", line 24, in wrapper
    return func(self, *a, **k)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 1208, in _compute_action_helper
    fwd_out = self.model.forward_exploration(input_dict)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 253, in wrapper
    raise e
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 251, in wrapper
    return func(self, input_data, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 371, in wrapper
    _validate(
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 162, in _validate
    raise SpecCheckingError(
ray.rllib.core.models.specs.checker.SpecCheckingError: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.
2025-07-22 23:06:33,772 - services.ray_training_orchestrator - ERROR - Training failed: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.

Ray Training stdout: {"type": "ray_training_metrics", "experiment_id": 4, "timestamp": 1753250793.7721736, "training_method": "ray_rllib", "success": false, "error": "output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>."}

Ray Training stderr: 2025-07-22 23:06:33,772 - services.ray_api_integration - ERROR - Ray training failed: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.

Ray Training stderr: 2025-07-22 23:06:33,774 - services.ray_api_integration - ERROR - Traceback (most recent call last):
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/worker_set.py", line 159, in __init__
    self._setup(
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/worker_set.py", line 229, in _setup
    self.add_workers(
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/worker_set.py", line 616, in add_workers
    raise result.get()
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/actor_manager.py", line 487, in __fetch_result
    result = ray.get(r)
             ^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2626, in get
    raise value
ray.exceptions.RayActorError: The actor died because of an error raised in its creation task, ray::RolloutWorker.__init__() (pid=54761, ip=172.23.15.241, actor_id=e9977887cdbd2ef08b344d5c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x76e18e94fe10>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_base.py", line 63, in validate
    raise ValueError(_INVALID_TYPE.format(self.dtype, type(data)))
ValueError: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54761, ip=172.23.15.241, actor_id=e9977887cdbd2ef08b344d5c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x76e18e94fe10>)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 160, in _validate
    spec.validate(data)
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/specs_dict.py", line 141, in validate
    raise ValueError(
ValueError: Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>

During handling of the above exception, another exception occurred:

ray::RolloutWorker.__init__() (pid=54761, ip=172.23.15.241, actor_id=e9977887cdbd2ef08b344d5c01000000, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x76e18e94fe10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 535, in __init__
    self._update_policy_map(policy_dict=self.policy_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1746, in _update_policy_map
    self._build_policy_map(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/rollout_worker.py", line 1857, in _build_policy_map
    new_policy = create_policy_for_framework(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/policy.py", line 141, in create_policy_for_framework
    return policy_class(observation_space, action_space, merged_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/ppo/ppo_torch_policy.py", line 64, in __init__
    self._initialize_loss_from_dummy_batch()
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/policy.py", line 1430, in _initialize_loss_from_dummy_batch
    actions, state_outs, extra_outs = self.compute_actions_from_input_dict(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 552, in compute_actions_from_input_dict
    return self._compute_action_helper(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/utils/threading.py", line 24, in wrapper
    return func(self, *a, **k)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/policy/torch_policy_v2.py", line 1208, in _compute_action_helper
    fwd_out = self.model.forward_exploration(input_dict)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 253, in wrapper
    raise e
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 251, in wrapper
    return func(self, input_data, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 371, in wrapper
    _validate(
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/core/models/specs/checker.py", line 162, in _validate
    raise SpecCheckingError(
ray.rllib.core.models.specs.checker.SpecCheckingError: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/micha/EmergentProtocolFramework/server/services/ray_api_integration.py", line 62, in start_ray_training
    result = await self.current_orchestrator.train()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/server/services/ray_training_orchestrator.py", line 114, in train
    return await self._train_with_ray()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/server/services/ray_training_orchestrator.py", line 141, in _train_with_ray
    algorithm = self.ray_integration.create_algorithm()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/server/services/ray_full_integration.py", line 650, in create_algorithm
    self.algorithm = config.build()
                     ^^^^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm_config.py", line 1137, in build
    return algo_class(
           ^^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm.py", line 516, in __init__
    super().__init__(
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/tune/trainable/trainable.py", line 161, in __init__
    self.setup(copy.deepcopy(self.config))
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm.py", line 638, in setup
    self.workers = WorkerSet(
                   ^^^^^^^^^^
  File "/home/micha/EmergentProtocolFramework/.venv/lib/python3.11/site-packages/ray/rllib/evaluation/worker_set.py", line 181, in __init__
    raise e.args[0].args[2]
ray.rllib.core.models.specs.checker.SpecCheckingError: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.


Ray Training stderr: (RolloutWorker pid=54763) INFO:services.marl_framework:MARL Framework initialized
(RolloutWorker pid=54763) INFO:services.ray_full_integration:BioInspiredMultiAgentEnv initialized with 30 agents

11:06:34 PM [express] GET /api/experiments 304 in 0ms :: [{"name":"test","description":"Bio-inspired …
11:06:34 PM [express] GET /api/training/status 304 in 1ms :: {"experiment":{"name":"test","descriptio…
11:06:34 PM [express] GET /api/metrics/experiment/4 304 in 0ms :: []
Ray Training stderr: 2025-07-22 23:06:35,422 - services.ray_full_integration - INFO - Ray integration cleaned up
2025-07-22 23:06:35,422 - services.ray_training_orchestrator - INFO - Ray training orchestrator cleaned up

Ray Training stdout: {"success": false, "message": "Ray training failed: output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>.", "error": "output spec validation failed on BioInspiredRLModule.forward_exploration, Mismatch found in data element ('action_dist',), which is a TensorSpec: Expected data type <class 'ray.rllib.models.distributions.Distribution'> but found <class 'torch.Tensor'>."}
{"success": true, "ray_available": true, "ray_error": null, "config_template": {"name": "Ray RLlib Bio-Inspired Training", "description": "Advanced multi-agent reinforcement learning with bio-inspired components", "total_episodes": 100, "learning_rate": 0.0003, "batch_size": 128, "train_batch_size": 4000, "hidden_dim": 256, "num_rollout_workers": 4, "num_attention_heads": 8, "pheromone_decay": 0.95, "neural_plasticity_rate": 0.1, "communication_range": 2.0, "breakthrough_threshold": 0.7, "max_steps_per_episode": 500, "gamma": 0.99, "lambda_": 0.95, "num_sgd_iter": 10, "num_envs_per_worker": 1, "rollout_fragment_length": 200}}